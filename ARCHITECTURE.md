# FlipBook System Architecture

## ğŸ›ï¸ High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        USER BROWSER                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Landing Page  â”‚  Auth Pages  â”‚  Dashboard  â”‚  Embed Page   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                â”‚             â”‚           â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚      NEXT.JS APPLICATION         â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
         â”‚  â”‚    App Router (React)      â”‚  â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
         â”‚  â”‚    API Routes              â”‚  â”‚
         â”‚  â”‚  - Auth                    â”‚  â”‚
         â”‚  â”‚  - Shops                   â”‚  â”‚
         â”‚  â”‚  - Menus                   â”‚  â”‚
         â”‚  â”‚  - Upload                  â”‚  â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚           â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”    â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  PostgreSQL  â”‚    â”‚ File System â”‚
      â”‚   Database   â”‚    â”‚  (uploads)  â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š Database Schema

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     User     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id           â”‚
â”‚ email        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”
â”‚ password     â”‚        â”‚
â”‚ name         â”‚        â”‚ owns
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
                        â”‚
                   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚     Shop     â”‚
                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                   â”‚ id           â”‚
                   â”‚ name         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚ slug         â”‚        â”‚
                   â”‚ description  â”‚        â”‚ belongs to
                   â”‚ userId       â”‚        â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
                                           â”‚
                                      â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                      â”‚     Menu     â”‚
                                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                      â”‚ id           â”‚
                                      â”‚ name         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”
                                      â”‚ slug         â”‚        â”‚
                                      â”‚ shopId       â”‚        â”‚ belongs to
                                      â”‚ published    â”‚        â”‚
                                      â”‚ settings     â”‚        â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
                                                              â”‚
                                                         â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                         â”‚     Page     â”‚
                                                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                                         â”‚ id           â”‚
                                                         â”‚ menuId       â”‚
                                                         â”‚ pageNumber   â”‚
                                                         â”‚ imageUrl     â”‚
                                                         â”‚ thumbnail    â”‚
                                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ User Flow Diagram

### Admin Flow
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Sign Up â”‚â”€â”€â”€â”€â–¶â”‚ Create  â”‚â”€â”€â”€â”€â–¶â”‚ Create  â”‚â”€â”€â”€â”€â–¶â”‚  Get    â”‚
â”‚ / Login â”‚     â”‚  Shop   â”‚     â”‚  Menu   â”‚     â”‚  Embed  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚               â”‚               â”‚               â”‚
     â”‚               â”‚               â”‚               â”‚
     â–¼               â–¼               â–¼               â–¼
  Auth API      Shops API      Menus API      Embed Code
  (NextAuth)    (Protected)    (Protected)    Generator
```

### Visitor Flow
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Visit    â”‚â”€â”€â”€â”€â–¶â”‚  Load    â”‚â”€â”€â”€â”€â–¶â”‚ Interact â”‚
â”‚ Website  â”‚     â”‚ Flipbook â”‚     â”‚ with Menuâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚               â”‚                  â”‚
     â”‚               â”‚                  â”‚
     â–¼               â–¼                  â–¼
  Embed Page    Public API         FlipBook
  (SSR)         (Fetch Data)       Component
```

## ğŸ”Œ API Architecture

### Public APIs (No Auth Required)
```
GET /api/public/menu/[shopSlug]/[menuSlug]
    â”‚
    â”œâ”€â–¶ Find Shop by slug
    â”œâ”€â–¶ Find Menu by slug (published only)
    â”œâ”€â–¶ Include Pages (ordered)
    â””â”€â–¶ Return JSON

GET /embed/[shopSlug]/[menuSlug]
    â”‚
    â”œâ”€â–¶ Server-Side Render
    â”œâ”€â–¶ Load Menu Data
    â”œâ”€â–¶ Render FlipBook Component
    â””â”€â–¶ Return HTML
```

### Protected APIs (Auth Required)
```
POST /api/shops
    â”‚
    â”œâ”€â–¶ Check Authentication
    â”œâ”€â–¶ Validate Input
    â”œâ”€â–¶ Generate Unique Slug
    â”œâ”€â–¶ Create Shop in DB
    â””â”€â–¶ Return Shop Data

POST /api/menus
    â”‚
    â”œâ”€â–¶ Check Authentication
    â”œâ”€â–¶ Verify Shop Ownership
    â”œâ”€â–¶ Generate Unique Slug
    â”œâ”€â–¶ Create Menu + Pages
    â””â”€â–¶ Return Menu Data

POST /api/upload
    â”‚
    â”œâ”€â–¶ Check Authentication
    â”œâ”€â–¶ Validate File Type
    â”œâ”€â–¶ Process File:
    â”‚   â”œâ”€â–¶ PDF â†’ Convert to Images
    â”‚   â””â”€â–¶ Image â†’ Optimize
    â”œâ”€â–¶ Generate Thumbnails
    â”œâ”€â–¶ Save to File System
    â””â”€â–¶ Return Page Data
```

## ğŸ“ Component Architecture

### Page Components
```
app/
â”œâ”€â”€ page.tsx                    Landing Page
â”œâ”€â”€ auth/
â”‚   â”œâ”€â”€ signin/page.tsx        Sign In Form
â”‚   â””â”€â”€ signup/page.tsx        Sign Up Form
â”œâ”€â”€ dashboard/
â”‚   â”œâ”€â”€ layout.tsx             Dashboard Shell (Sidebar + Nav)
â”‚   â”œâ”€â”€ page.tsx               Dashboard Home (Stats)
â”‚   â””â”€â”€ shops/
â”‚       â”œâ”€â”€ page.tsx           Shops List
â”‚       â”œâ”€â”€ new/page.tsx       Create Shop Form
â”‚       â””â”€â”€ [shopId]/page.tsx  Shop Detail (Menus List)
â””â”€â”€ embed/
    â””â”€â”€ [shopSlug]/[menuSlug]/page.tsx  Public Embed
```

### Reusable Components
```
components/
â”œâ”€â”€ FlipBook/
â”‚   â”œâ”€â”€ FlipBook.tsx          Main viewer with animations
â”‚   â””â”€â”€ FlipBook3D.tsx        Alternative Three.js version
â””â”€â”€ FileUpload.tsx            Drag & drop upload UI
```

## ğŸ”’ Authentication Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Login â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  POST /api/auth  â”‚
â”‚  (NextAuth)      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Check Credentialsâ”‚â”€â”€â”€â”€â”€â–¶â”‚  Database   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Generate JWT     â”‚
â”‚ Session Token    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Set Cookie       â”‚
â”‚ Redirect to      â”‚
â”‚ Dashboard        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¤ File Upload Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Selects â”‚
â”‚ PDF/Image    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FileUpload       â”‚
â”‚ Component        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/upload â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â–¶ PDF?
       â”‚   â”‚
       â”‚   â–¼
       â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚   â”‚ PDF.js          â”‚
       â”‚   â”‚ Convert to      â”‚
       â”‚   â”‚ Images          â”‚
       â”‚   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚         â”‚
       â”‚         â–¼
       â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚   â”‚ Generate        â”‚
       â”‚   â”‚ Thumbnails      â”‚
       â”‚   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚         â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚
                         â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚ Save Files  â”‚
                   â”‚ to uploads/ â”‚
                   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚ Create Page â”‚
                   â”‚ Records     â”‚
                   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚ Return      â”‚
                   â”‚ Page Data   â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¨ FlipBook Rendering Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Embed Page   â”‚
â”‚ Loaded       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Fetch Menu Data  â”‚
â”‚ from API/Databaseâ”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FlipBook         â”‚
â”‚ Component        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â–¶ Initialize State
       â”‚   â”œâ”€â–¶ currentPage = 0
       â”‚   â”œâ”€â–¶ isFlipping = false
       â”‚   â””â”€â–¶ zoom = 1
       â”‚
       â”œâ”€â–¶ Load Current Page
       â”‚   â”œâ”€â–¶ <img src={page.imageUrl} />
       â”‚   â””â”€â–¶ Preload adjacent pages
       â”‚
       â”œâ”€â–¶ User Interaction
       â”‚   â”œâ”€â–¶ Click/Swipe
       â”‚   â”œâ”€â–¶ Keyboard (Arrow keys)
       â”‚   â””â”€â–¶ Controls (Prev/Next)
       â”‚
       â”œâ”€â–¶ Animate Page Flip
       â”‚   â”œâ”€â–¶ Framer Motion
       â”‚   â”œâ”€â–¶ 3D Rotation Effect
       â”‚   â””â”€â–¶ Update currentPage
       â”‚
       â””â”€â–¶ Render UI
           â”œâ”€â–¶ Page Navigation
           â”œâ”€â–¶ Zoom Controls
           â”œâ”€â–¶ Thumbnails
           â””â”€â–¶ Fullscreen
```

## ğŸ” Security Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Request from Browser            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Middleware    â”‚
         â”‚  (Auth Check)  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Protected?     â”‚
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
              â”‚        â”‚
         YES  â”‚        â”‚ NO
              â”‚        â”‚
              â–¼        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Check       â”‚  â”‚ Continue â”‚
    â”‚ JWT Token   â”‚  â”‚ Request  â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
    Valid â”‚ Invalid
          â”‚
          â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Verify User â”‚
    â”‚ Ownership   â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚ Execute    â”‚
    â”‚ Request    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Deployment Architecture

### Development
```
localhost:3000
    â”‚
    â”œâ”€â–¶ Next.js Dev Server
    â”œâ”€â–¶ Hot Reload
    â”œâ”€â–¶ Local MySQL
    â””â”€â–¶ Local File Storage
```

### Production (Recommended: Vercel + Supabase)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vercel          â”‚
â”‚  â”œâ”€ Next.js App  â”‚
â”‚  â”œâ”€ Edge Network â”‚
â”‚  â””â”€ Serverless   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         â”‚            â”‚
    â–¼         â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MySQL  â”‚ â”‚   S3   â”‚ â”‚CloudFr.â”‚
â”‚Databaseâ”‚ â”‚(Files) â”‚ â”‚  (CDN) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š Data Flow Example

### Creating a Menu
```
1. User fills form in Dashboard
   â†“
2. Uploads PDF file
   â†“
3. POST /api/upload
   â†“
4. Server processes PDF â†’ Images
   â†“
5. Files saved to uploads/
   â†“
6. POST /api/menus with page data
   â†“
7. Database records created:
   - Menu record
   - Multiple Page records
   â†“
8. Redirect to Shop page
   â†“
9. Menu appears in list
```

### Viewing Embedded Menu
```
1. Visitor opens website with embed
   â†“
2. Browser loads iframe
   â†“
3. GET /embed/shop-slug/menu-slug
   â†“
4. Server fetches data (SSR):
   - Shop info
   - Menu info
   - All pages
   â†“
5. FlipBook component renders
   â†“
6. Pages loaded from uploads/
   â†“
7. User interacts with flipbook
```

## ğŸ§© Technology Stack Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Frontend                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ React 18 â”‚ Next.js 14 â”‚ TypeScript      â”‚
â”‚ Tailwind â”‚ Framer Motion â”‚ Three.js     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Backend                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Next.js API â”‚ NextAuth â”‚ Prisma ORM     â”‚
â”‚ Sharp â”‚ PDF.js â”‚ Canvas                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             Database                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         MySQL 5.7+ / 8.0+                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ Performance Considerations

### Optimization Points
```
1. Image Optimization
   â”œâ”€â–¶ Sharp for compression
   â”œâ”€â–¶ Thumbnail generation
   â””â”€â–¶ Lazy loading

2. Database Queries
   â”œâ”€â–¶ Indexed fields (slug, userId)
   â”œâ”€â–¶ Eager loading (include)
   â””â”€â–¶ Pagination ready

3. Caching Strategy
   â”œâ”€â–¶ Next.js automatic caching
   â”œâ”€â–¶ Static generation for embeds
   â””â”€â–¶ CDN for static assets

4. Bundle Size
   â”œâ”€â–¶ Code splitting
   â”œâ”€â–¶ Dynamic imports
   â””â”€â–¶ Tree shaking
```

---

## ğŸ“š References

- **Next.js App Router:** https://nextjs.org/docs/app
- **Prisma ORM:** https://www.prisma.io
- **NextAuth.js:** https://next-auth.js.org
- **Framer Motion:** https://www.framer.com/motion

---

**This architecture is designed to be:**
- âœ… Scalable
- âœ… Maintainable
- âœ… Secure
- âœ… Performant
- âœ… Developer-friendly

